<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: FunctionsFramework
  
    &mdash; Functions
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "FunctionsFramework";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (F)</a> &raquo;
    
    
    <span class="title">FunctionsFramework</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: FunctionsFramework
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/functions_framework/version.rb<span class="defines">,<br />
  lib/functions_framework/cli.rb,<br /> lib/functions_framework/server.rb,<br /> lib/functions_framework/testing.rb,<br /> lib/functions_framework/function.rb,<br /> lib/functions_framework/registry.rb,<br /> lib/functions_framework/legacy_event_converter.rb,<br /> lib/functions_framework.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>The Functions Framework for Ruby.</p>

<p>Functions Framework is an open source framework for writing lightweight,
portable Ruby functions that run in a serverless environment. For general
information about the Functions Framework, see
<a href="https://github.com/GoogleCloudPlatform/functions-framework">https://github.com/GoogleCloudPlatform/functions-framework</a>.
To get started with the functions framework for Ruby, see
<a href="https://github.com/GoogleCloudPlatform/functions-framework-ruby">https://github.com/GoogleCloudPlatform/functions-framework-ruby</a> for basic
examples.</p>

<h2 id="inside-the-functionsframework-module">Inside the FunctionsFramework module</h2>

<p>The FunctionsFramework module includes the main entry points for the
functions framework. Use the <span class='object_link'><a href="#http-class_method" title="FunctionsFramework.http (method)">FunctionsFramework.http</a></span>,
event, or <span class='object_link'><a href="#cloud_event-class_method" title="FunctionsFramework.cloud_event (method)">FunctionsFramework.cloud_event</a></span> methods to
define functions. To serve functions via a web service, invoke the
<code>functions-framework-ruby</code> executable, or use the <span class='object_link'><a href="#start-class_method" title="FunctionsFramework.start (method)">FunctionsFramework.start</a></span>
or <span class='object_link'><a href="#run-class_method" title="FunctionsFramework.run (method)">FunctionsFramework.run</a></span> methods.</p>

<h2 id="internal-modules">Internal modules</h2>

<p>Here is a roadmap to the internal modules in the Ruby functions framework.</p>

<ul>
<li> <span class='object_link'><a href="FunctionsFramework/CLI.html" title="FunctionsFramework::CLI (class)">CLI</a></span> is the implementation of the
<code>functions-framework-ruby</code> executable. Most apps will not need to interact
with this class directly.</li>
<li> <span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">Function</a></span> is the internal representation of a
function, indicating the type of function (http or cloud event), the
name of the function, and the block of code implementing it. Most apps
do not need to interact with this class directly.</li>
<li> <span class='object_link'><a href="FunctionsFramework/Registry.html" title="FunctionsFramework::Registry (class)">Registry</a></span> looks up functions by name. When you
define a set of named functions, they are added to a registry, and when
you start a server and specify the target function by name, it is looked
up from the registry. Most apps do not need to interact with this class
directly.</li>
<li> <span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">Server</a></span> is a web server that makes a function
available via HTTP. It wraps the Puma web server and runs a specific
<span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">Function</a></span>. Many apps can simply run the
<code>functions-framework-ruby</code> executable to spin up a server. However, if you
need closer control over your execution environment, you can use the
<span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">Server</a></span> class to run a server. Note that, in most
cases, it is easier to use the <span class='object_link'><a href="#start-class_method" title="FunctionsFramework.start (method)">FunctionsFramework.start</a></span> or
<span class='object_link'><a href="#run-class_method" title="FunctionsFramework.run (method)">FunctionsFramework.run</a></span> wrapper methods rather than instantiate a
<span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">Server</a></span> class directly.</li>
<li> <span class='object_link'><a href="FunctionsFramework/Testing.html" title="FunctionsFramework::Testing (module)">Testing</a></span> provides helpers that are useful when
writing unit tests for functions.</li>
</ul>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="FunctionsFramework/Testing.html" title="FunctionsFramework::Testing (module)">Testing</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="FunctionsFramework/CLI.html" title="FunctionsFramework::CLI (class)">CLI</a></span>, <span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">Function</a></span>, <span class='object_link'><a href="FunctionsFramework/LegacyEventConverter.html" title="FunctionsFramework::LegacyEventConverter (class)">LegacyEventConverter</a></span>, <span class='object_link'><a href="FunctionsFramework/Registry.html" title="FunctionsFramework::Registry (class)">Registry</a></span>, <span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">Server</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VERSION-constant" class="">VERSION =
          <div class="docstring">
  <div class="discussion">
    <p>Version of the Ruby Functions Framework</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.4.0</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="DEFAULT_TARGET-constant" class="">DEFAULT_TARGET =
          <div class="docstring">
  <div class="discussion">
    <p>The default target function name. If you define a function without
specifying a name, or run the framework without giving a target, this name
is used.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>function</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="DEFAULT_SOURCE-constant" class="">DEFAULT_SOURCE =
          <div class="docstring">
  <div class="discussion">
    <p>The default source file path. The CLI loads functions from this file if no
source file is given explicitly.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>./app.rb</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="CloudEvents-constant" class="">CloudEvents =
          <div class="docstring">
  <div class="discussion">
    <p>The CloudEvents implementation was extracted to become the official
CloudEvents SDK. This alias is left here for backward compatibility.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='op'>::</span><span class='const'>CloudEvents</span></pre></dd>
      
    </dl>
  




  <h2>Class Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#global_registry-class_method" title="global_registry (class method)">.<strong>global_registry</strong>  &#x21d2; FunctionsFramework::Registry </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The &quot;global&quot; registry that holds events defined by the <span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span> class methods.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#logger-class_method" title="logger (class method)">.<strong>logger</strong>  &#x21d2; Logger </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A &quot;global&quot; logger that is used by the framework&#39;s web server, and can also be used by functions.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cloud_event-class_method" title="cloud_event (class method)">.<strong>cloud_event</strong>(name = DEFAULT_TARGET, &amp;block)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Define a function that responds to CloudEvents.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#http-class_method" title="http (class method)">.<strong>http</strong>(name = DEFAULT_TARGET, &amp;block)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Define a function that responds to HTTP requests.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_startup-class_method" title="on_startup (class method)">.<strong>on_startup</strong>(&amp;block)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Define a server startup task.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-class_method" title="run (class method)">.<strong>run</strong>(target) {|FunctionsFramework::Server::Config| ... } &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Run the functions framework server and block until it stops.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-class_method" title="start (class method)">.<strong>start</strong>(target) {|FunctionsFramework::Server::Config| ... } &#x21d2; FunctionsFramework::Server </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Run startup tasks, then start the functions framework server in the background.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#typed-class_method" title="typed (class method)">.<strong>typed</strong>(name = DEFAULT_TARGET, request_class: nil, &amp;block)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Define a Typed function that responds to HTTP requests.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="class_attr_details" class="attr_details">
    <h2>Class Attribute Details</h2>
    
      
      <span id="global_registry=-class_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="global_registry-class_method">
  
    .<strong>global_registry</strong>  &#x21d2; <tt><span class='object_link'><a href="FunctionsFramework/Registry.html" title="FunctionsFramework::Registry (class)">FunctionsFramework::Registry</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The &quot;global&quot; registry that holds events defined by the
<span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span> class methods.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FunctionsFramework/Registry.html" title="FunctionsFramework::Registry (class)">FunctionsFramework::Registry</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_global_registry'>global_registry</span>
  <span class='ivar'>@global_registry</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="logger=-class_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="logger-class_method">
  
    .<strong>logger</strong>  &#x21d2; <tt>Logger</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>A &quot;global&quot; logger that is used by the framework&#39;s web server, and can
also be used by functions.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Logger</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 115</span>

<span class='kw'>def</span> <span class='id identifier rubyid_logger'>logger</span>
  <span class='ivar'>@logger</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cloud_event-class_method">
  
    .<strong>cloud_event</strong>(name = DEFAULT_TARGET, &amp;block)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Define a function that responds to CloudEvents.</p>

<p>You must provide a name for the function, and a block that implements the
function. The block should take one argument: the event object of type
<a href="https://cloudevents.github.io/sdk-ruby/latest/CloudEvents/Event"><code>CloudEvents::Event</code></a>.
Any return value is ignored.</p>

<h2 id="example">Example</h2>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span></span><span class='period'>.</span><span class='id identifier rubyid_cloud_event'>cloud_event</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-function</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_event'>event</span><span class='op'>|</span>
  <span class='const'><span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="#logger-class_method" title="FunctionsFramework.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Event data: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_TARGET</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The function name. Defaults to <span class='object_link'><a href="#DEFAULT_TARGET-constant" title="FunctionsFramework::DEFAULT_TARGET (constant)">DEFAULT_TARGET</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The function code as a proc.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195
196</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cloud_event'>cloud_event</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#DEFAULT_TARGET-constant" title="FunctionsFramework::DEFAULT_TARGET (constant)">DEFAULT_TARGET</a></span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_global_registry'>global_registry</span><span class='period'>.</span><span class='id identifier rubyid_add_cloud_event'>add_cloud_event</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="http-class_method">
  
    .<strong>http</strong>(name = DEFAULT_TARGET, &amp;block)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Define a function that responds to HTTP requests.</p>

<p>You must provide a name for the function, and a block that implements the
function. The block should take a single <code>Rack::Request</code> argument. It
should return one of the following:</p>

<ul>
<li> A standard 3-element Rack response array. See
<a href="https://github.com/rack/rack/blob/master/SPEC">https://github.com/rack/rack/blob/master/SPEC</a></li>
<li> A <code>Rack::Response</code> object.</li>
<li> A simple String that will be sent as the response body.</li>
<li> A Hash object that will be encoded as JSON and sent as the response
body.</li>
</ul>

<h2 id="example">Example</h2>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span></span><span class='period'>.</span><span class='id identifier rubyid_http'>http</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-function</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_request'>request</span><span class='op'>|</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I received a request for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_TARGET</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The function name. Defaults to <span class='object_link'><a href="#DEFAULT_TARGET-constant" title="FunctionsFramework::DEFAULT_TARGET (constant)">DEFAULT_TARGET</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The function code as a proc.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 140</span>

<span class='kw'>def</span> <span class='id identifier rubyid_http'>http</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#DEFAULT_TARGET-constant" title="FunctionsFramework::DEFAULT_TARGET (constant)">DEFAULT_TARGET</a></span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_global_registry'>global_registry</span><span class='period'>.</span><span class='id identifier rubyid_add_http'>add_http</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_startup-class_method">
  
    .<strong>on_startup</strong>(&amp;block)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Define a server startup task. This is useful for initializing shared
resources that should be accessible across all function invocations in
this Ruby VM.</p>

<p>Startup tasks are run just before a server starts. All startup tasks are
guaranteed to complete before any function executes. However, they are
run only when preparing to run functions. They are not run, for example,
if an app is loaded to verify its integrity during deployment.</p>

<p>Startup tasks are passed the <span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">Function</a></span> identifying
the function to execute, and have no return value.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The startup task</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216
217</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 214</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_startup'>on_startup</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_global_registry'>global_registry</span><span class='period'>.</span><span class='id identifier rubyid_add_startup_task'>add_startup_task</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run-class_method">
  
    .<strong>run</strong>(target) {|FunctionsFramework::Server::Config| ... } &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Run the functions framework server and block until it stops. The server
will look up the given target function name in the global registry.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">FunctionsFramework::Function</a></span></tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The function to run,
or the name of the function to look up in the global registry.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FunctionsFramework/Server/Config.html" title="FunctionsFramework::Server::Config (class)">FunctionsFramework::Server::Config</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A config object that can be
manipulated to configure the server.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260
261
262</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 258</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_server'>server</span> <span class='op'>=</span> <span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_wait_until_stopped'>wait_until_stopped</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-class_method">
  
    .<strong>start</strong>(target) {|FunctionsFramework::Server::Config| ... } &#x21d2; <tt><span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">FunctionsFramework::Server</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Run startup tasks, then start the functions framework server in the
background. The startup tasks and target function will be looked up in
the global registry.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">FunctionsFramework::Function</a></span></tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The function to run,
or the name of the function to look up in the global registry.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FunctionsFramework/Server/Config.html" title="FunctionsFramework::Server::Config (class)">FunctionsFramework::Server::Config</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A config object that can be
manipulated to configure the server.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">FunctionsFramework::Server</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 230</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>functions_framework/server</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="FunctionsFramework/Function.html" title="FunctionsFramework::Function (class)">Function</a></span></span>
    <span class='id identifier rubyid_function'>function</span> <span class='op'>=</span> <span class='id identifier rubyid_target'>target</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_function'>function</span> <span class='op'>=</span> <span class='id identifier rubyid_global_registry'>global_registry</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Undefined function: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_function'>function</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_globals'>globals</span> <span class='op'>=</span> <span class='id identifier rubyid_function'>function</span><span class='period'>.</span><span class='id identifier rubyid_populate_globals'>populate_globals</span>
  <span class='id identifier rubyid_server'>server</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FunctionsFramework/Server.html" title="FunctionsFramework::Server (class)">Server</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FunctionsFramework/Server.html#initialize-instance_method" title="FunctionsFramework::Server#initialize (method)">new</a></span></span> <span class='id identifier rubyid_function'>function</span><span class='comma'>,</span> <span class='id identifier rubyid_globals'>globals</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_global_registry'>global_registry</span><span class='period'>.</span><span class='id identifier rubyid_startup_tasks'>startup_tasks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='op'>|</span>
    <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span> <span class='id identifier rubyid_function'>function</span><span class='comma'>,</span> <span class='label'>globals:</span> <span class='id identifier rubyid_globals'>globals</span><span class='comma'>,</span> <span class='label'>logger:</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_globals'>globals</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_respond_to_signals'>respond_to_signals</span>
  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="typed-class_method">
  
    .<strong>typed</strong>(name = DEFAULT_TARGET, request_class: nil, &amp;block)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Define a Typed function that responds to HTTP requests.</p>

<p>You must provide a name for the function, and a block that implements the
function. The block should take a single argument representing the request
payload. If a <code>request_type</code> is provided, the argument object will be of
the given decoded type; otherwise, it will be a JSON hash. The  block
should return a JSON hash or an object that implements <code>#to_json</code>.</p>

<h2 id="example">Example</h2>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span></span><span class='period'>.</span><span class='id identifier rubyid_typed'>typed</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-sum-function</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_add_request'>add_request</span><span class='op'>|</span>
  <span class='lbrace'>{</span><span class='label'>sum:</span> <span class='id identifier rubyid_add_request'>add_request</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>num1</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_add_response'>add_response</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>num2</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="example-with-type">Example with Type</h2>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="" title="FunctionsFramework (module)">FunctionsFramework</a></span></span><span class='period'>.</span><span class='id identifier rubyid_typed'>typed</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                        <span class='label'>request_class:</span> <span class='const'>MyCustomType</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_custom_type'>custom_type</span><span class='op'>|</span>
  <span class='id identifier rubyid_custom_type'>custom_type</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_TARGET</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The function name. Defaults to <span class='object_link'><a href="#DEFAULT_TARGET-constant" title="FunctionsFramework::DEFAULT_TARGET (constant)">DEFAULT_TARGET</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>request_class</span>
      
      
        <span class='type'>(<tt>#decode_json</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>An optional class which will be used to
decode the request if it implements a <code>decode_json</code> static method.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The function code as a proc @return [self]</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/functions_framework.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_typed'>typed</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#DEFAULT_TARGET-constant" title="FunctionsFramework::DEFAULT_TARGET (constant)">DEFAULT_TARGET</a></span></span><span class='comma'>,</span> <span class='label'>request_class:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_global_registry'>global_registry</span><span class='period'>.</span><span class='id identifier rubyid_add_typed'>add_typed</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>request_class:</span> <span class='id identifier rubyid_request_class'>request_class</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Jun 16 20:39:50 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.0.6).
</div>

    </div>
  </body>
</html>